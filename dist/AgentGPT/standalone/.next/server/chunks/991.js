"use strict";exports.id=991,exports.ids=[991],exports.modules={988:(e,r,n)=>{n.a(e,async(e,t)=>{try{n.d(r,{L:()=>c});var s=n(9783),a=n.n(s),o=n(7459),i=n.n(o),E=n(3598),_=n.n(E),l=n(545),I=e([l]);l=(I.then?(await I)():I)[0];let c={providers:[_()({clientId:l.Nb.GOOGLE_CLIENT_ID??"",clientSecret:l.Nb.GOOGLE_CLIENT_SECRET??"",allowDangerousEmailAccountLinking:!0}),i()({clientId:l.Nb.GITHUB_CLIENT_ID??"",clientSecret:l.Nb.GITHUB_CLIENT_SECRET??"",allowDangerousEmailAccountLinking:!0}),a()({clientId:l.Nb.DISCORD_CLIENT_ID??"",clientSecret:l.Nb.DISCORD_CLIENT_SECRET??"",allowDangerousEmailAccountLinking:!0})],pages:{signIn:"/signin"}};t()}catch(e){t(e)}})},3991:(e,r,n)=>{n.a(e,async(e,t)=>{try{n.d(r,{L:()=>authOptions,W:()=>getServerAuthSession});var s,a=n(2104),o=n(1831),i=n.n(o),E=n(3227),_=n(988),l=n(1632),I=n(3112),c=n(6270),L=e([_,l,I,c]);[_,l,I,c]=L.then?(await L)():L;let T=(0,a.PrismaAdapter)(c._);T.createUser=(s=T.createUser,async e=>{let r=await s(e);return r});let N={adapter:T,callbacks:{async session({session:e,user:r}){let[n,t]=await Promise.all([c._.session.findFirstOrThrow({where:{userId:r.id},orderBy:{expires:"desc"}}),c._.organizationUser.findMany({where:{user_id:r.id},include:{organization:!0}})]);return e.accessToken=n.sessionToken,e.user.id=r.id,e.user.superAdmin=r.superAdmin,e.user.organizations=t.map(e=>({id:e.organization.id,name:e.organization.name,role:e.role})),e}}},authOptions=(e,r)=>{let n="development"===I.O.NEXT_PUBLIC_VERCEL_ENV?(0,l.Y)(N.adapter,e,r):_.L;return i()(N,n)},getServerAuthSession=e=>(0,E.getServerSession)(e.req,e.res,authOptions(e.req,e.res));t()}catch(e){t(e)}})},1632:(e,r,n)=>{n.a(e,async(e,t)=>{try{n.d(r,{Y:()=>options});var s=n(8982),a=n(7449),o=n.n(a),i=n(6555),E=n(9926),_=e([i,E]);[i,E]=_.then?(await _)():_;let monthFromNow=()=>{let e=new Date(Date.now());return new Date(e.setMonth(e.getMonth()+1))},options=(e,r,n)=>({adapter:e,providers:[o()({name:"Username, Development Only (Insecure)",credentials:{name:{label:"Username",type:"text"},superAdmin:{label:"SuperAdmin",type:"text"}},async authorize(r,n){if(!r)return null;let t=E.z.object({name:E.z.string().min(1),superAdmin:E.z.preprocess(e=>"true"===e,E.z.boolean()).default(!1)}).parse(r),s=await e.getUserByEmail(t.name);return s?e.updateUser({id:s.id,name:t.name,superAdmin:t.superAdmin}):e.createUser({name:t.name,email:t.name,image:void 0,emailVerified:null,superAdmin:!1})}})],pages:{signIn:"/signin"},callbacks:{redirect:e=>e.url.startsWith(e.baseUrl)?e.url:e.baseUrl,async signIn({user:t}){if(t){let a=await e.createSession({sessionToken:(0,i.v4)(),userId:t.id,expires:monthFromNow()});(0,s.setCookie)("next-auth.session-token",a.sessionToken,{expires:a.expires,req:r,res:n})}return!0}},jwt:{encode:()=>{let e=(0,s.getCookie)("next-auth.session-token",{req:r,res:n});return function(e){switch(typeof e){case"boolean":return e.toString();case"string":return e;default:return""}}(e)},decode:()=>null}});t()}catch(e){t(e)}})},6270:(e,r,n)=>{n.a(e,async(e,t)=>{try{n.d(r,{_:()=>E});var s=n(3524),a=n(3112),o=e([a]);a=(o.then?(await o)():o)[0];let i=globalThis,E=i.prisma||new s.PrismaClient({log:"development"===a.O.NODE_ENV?["query","error","warn"]:["error"]});t()}catch(e){t(e)}})},5870:(e,r,n)=>{n.a(e,async(e,t)=>{try{n.d(r,{O:()=>i,o:()=>formatErrors});var s=n(545),a=e([s]);s=(a.then?(await a)():a)[0];let o=s.Xq.safeParse(s.xZ),formatErrors=e=>Object.entries(e).map(([e,r])=>{if(r&&"_errors"in r)return`${e}: ${r._errors.join(", ")}
`}).filter(Boolean);if(!o.success)throw console.error("❌ Invalid environment variables:\n",...formatErrors(o.error.format())),Error("Invalid environment variables");for(let e of Object.keys(o.data))if(!e.startsWith("NEXT_PUBLIC_"))throw console.warn(`❌ Invalid public environment variable name: ${e}. It must begin with 'NEXT_PUBLIC_'`),Error("Invalid public environment variable name");let i=o.data;t()}catch(e){t(e)}})},545:(e,r,n)=>{n.a(e,async(e,t)=>{try{n.d(r,{Nb:()=>i,Rz:()=>o,Xq:()=>E,xZ:()=>_});var s=n(9926),a=e([s]);function stringToBoolean(){return s.z.preprocess(e=>"true"===e,s.z.boolean())}s=(a.then?(await a)():a)[0];let o=s.z.object({DATABASE_URL:s.z.string().url(),NODE_ENV:s.z.enum(["development","test","production"]),NEXTAUTH_SECRET:s.z.string().min(1).trim(),NEXTAUTH_URL:s.z.preprocess(e=>process.env.VERCEL_URL??e,process.env.VERCEL?s.z.string():s.z.string().url()),OPENAI_API_KEY:s.z.string().min(1).trim().optional(),GOOGLE_CLIENT_ID:s.z.string().min(1).trim().optional(),GOOGLE_CLIENT_SECRET:s.z.string().min(1).trim().optional(),GITHUB_CLIENT_ID:s.z.string().min(1).trim().optional(),GITHUB_CLIENT_SECRET:s.z.string().min(1).trim().optional(),DISCORD_CLIENT_ID:s.z.string().min(1).trim().optional(),DISCORD_CLIENT_SECRET:s.z.string().min(1).trim().optional()}),i={DATABASE_URL:process.env.DATABASE_URL,NODE_ENV:"production",NEXTAUTH_SECRET:process.env.NEXTAUTH_SECRET,NEXTAUTH_URL:process.env.NEXTAUTH_URL,OPENAI_API_KEY:process.env.OPENAI_API_KEY,GOOGLE_CLIENT_ID:process.env.GOOGLE_CLIENT_ID,GOOGLE_CLIENT_SECRET:process.env.GOOGLE_CLIENT_SECRET,GITHUB_CLIENT_ID:process.env.GITHUB_CLIENT_ID,GITHUB_CLIENT_SECRET:process.env.GITHUB_CLIENT_SECRET,DISCORD_CLIENT_ID:process.env.DISCORD_CLIENT_ID,DISCORD_CLIENT_SECRET:process.env.DISCORD_CLIENT_SECRET},E=s.z.object({NEXT_PUBLIC_EXPERIMENTAL_FF_ENABLED:stringToBoolean().default(!1),NEXT_PUBLIC_CDN:s.z.string().default(""),NEXT_PUBLIC_VERCEL_ENV:s.z.enum(["production","preview","development","test"]).default("development"),NEXT_PUBLIC_FF_MOCK_MODE_ENABLED:stringToBoolean().default(!1),NEXT_PUBLIC_FF_SID_ENABLED:stringToBoolean().default(!1),NEXT_PUBLIC_VERCEL_URL:s.z.string().default("http://localhost:3000"),NEXT_PUBLIC_BACKEND_URL:s.z.string().url().default("http://localhost:8000"),NEXT_PUBLIC_MAX_LOOPS:s.z.coerce.number().default(25),NEXT_PUBLIC_PUSHER_APP_KEY:s.z.string().optional()}),_={NEXT_PUBLIC_CDN:process.env.NEXT_PUBLIC_CDN,NEXT_PUBLIC_EXPERIMENTAL_FF_ENABLED:process.env.NEXT_PUBLIC_EXPERIMENTAL_FF_ENABLED,NEXT_PUBLIC_VERCEL_ENV:process.env.NEXT_PUBLIC_VERCEL_ENV,NEXT_PUBLIC_VERCEL_URL:process.env.NEXT_PUBLIC_VERCEL_URL,NEXT_PUBLIC_BACKEND_URL:process.env.NEXT_PUBLIC_BACKEND_URL,NEXT_PUBLIC_FF_MOCK_MODE_ENABLED:process.env.NEXT_PUBLIC_FF_MOCK_MODE_ENABLED,NEXT_PUBLIC_FF_SID_ENABLED:process.env.NEXT_PUBLIC_FF_SID_ENABLED,NEXT_PUBLIC_MAX_LOOPS:process.env.NEXT_PUBLIC_MAX_LOOPS,NEXT_PUBLIC_PUSHER_APP_KEY:process.env.NEXT_PUBLIC_PUSHER_APP_KEY};t()}catch(e){t(e)}})},3112:(e,r,n)=>{n.a(e,async(e,t)=>{try{n.d(r,{O:()=>E});var s=n(5870),a=n(545),o=e([s,a]);[s,a]=o.then?(await o)():o;let i=a.Rz.safeParse(a.Nb);if(!i.success)throw console.error("❌ Invalid environment variables:\n",...(0,s.o)(i.error.format())),Error("Invalid environment variables");for(let e of Object.keys(i.data))if(e.startsWith("NEXT_PUBLIC_"))throw console.warn("❌ You are exposing a server-side env-variable:",e),Error("You are exposing a server-side env-variable");let E={...i.data,...s.O};t()}catch(e){t(e)}})}};
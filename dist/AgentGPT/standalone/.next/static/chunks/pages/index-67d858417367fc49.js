(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(t,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(4301)}])},9455:function(t,s,a){"use strict";var n=a(5893),r=a(6010);a(7294);var o=a(9583);s.Z=t=>{let{children:s,className:a,...l}=t;return(0,n.jsx)("div",{className:(0,r.Z)("rounded-full bg-gradient-to-tl from-[#A02BFE] via-[#02FCF1] to-[#A02BFE] p-[1px] subpixel-antialiased",a),children:(0,n.jsxs)("a",{className:"animate-border-pulse py group relative flex w-max cursor-pointer items-center gap-2 rounded-full bg-black px-4 py-2 text-xs text-white",...l,children:[(0,n.jsx)("span",{children:s}),(0,n.jsx)(o.Dli,{size:10,className:"font-thin text-gray-400 transition-transform duration-300 group-hover:translate-x-1"})]})})}},9654:function(t,s,a){"use strict";a.d(s,{r:function(){return useSettings}});var n=a(1163),r=a(828),o=a(7294),l=a(3407),c=a(5588),u=a(6947);function useSettings(){let[t,s]=(0,o.useState)((0,c.jR)()),a=l.ZX.use.modelSettings(),d=l.ZX.use.updateSettings(),h=(0,n.useRouter)(),{i18n:g}=(0,r.$G)();(0,o.useEffect)(()=>{s(a)},[a]),(0,o.useEffect)(()=>{h.locale!==a.language.code&&d("language",(0,u.we)(h.locale||"en"))},[h,a.language,d]);let updateLangauge=async t=>{await g.changeLanguage(t.code);let{pathname:s,asPath:a,query:n}=h;await h.push({pathname:s,query:n},a,{locale:t.code})};return{settings:t,updateSettings:d,updateLangauge:updateLangauge}}},4301:function(t,s,a){"use strict";let n,r,o;a.r(s),a.d(s,{__N_SSG:function(){return eF},default:function(){return pages}});var l=a(5893),c=a(828),u=a(7294),d=a(9583),h=a(231),g=a(4873);function HelpDialog(){let[t,s]=(0,u.useState)(!1);(0,u.useEffect)(()=>{let t="agentgpt-modal-opened-v0.2",a=localStorage.getItem(t);setTimeout(()=>{null==a&&s(!0)},1500),localStorage.setItem(t,JSON.stringify(!0))},[]);let[a]=(0,c.$G)();return(0,l.jsx)(g.Z,{inline:!0,open:t,setOpen:s,title:"Welcome!",actions:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-sky-500 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-sky-400",onClick:()=>{s(!1)},children:"Get Started"})}),children:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{children:"AgentGPT is the next generation of Google search. Ask any question and watch as an AI Agent gives you the perfect answer after aggregating relevant sources from across the internet."}),(0,l.jsx)("br",{}),(0,l.jsx)("p",{className:"mt-2 text-center font-bold",children:a("FOLLOW_THE_JOURNEY",{ns:"help"})}),(0,l.jsxs)("div",{className:"mt-4 flex w-full items-center justify-center gap-5",children:[(0,l.jsx)("div",{className:"cursor-pointer rounded-full bg-slate-6 p-3 hover:bg-slate-8",onClick:()=>window.open("https://discord.gg/jdSBAnmdnY","_blank"),children:(0,l.jsx)(d.j2d,{size:30})}),(0,l.jsx)("div",{className:"cursor-pointer rounded-full bg-slate-6 p-3 hover:bg-slate-8",onClick:()=>window.open("https://twitter.com/asimdotshrestha/status/1644883727707959296","_blank"),children:(0,l.jsx)(h.LCd,{size:30})}),(0,l.jsx)("div",{className:"cursor-pointer rounded-full bg-slate-6 p-3 hover:bg-slate-8",onClick:()=>window.open("https://github.com/reworkd/AgentGPT","_blank"),children:(0,l.jsx)(d.hJX,{size:30})})]})]})})}var m=a(9579);let SignInDialog=t=>{let{show:s,setOpen:a}=t,{signIn:n}=(0,m.a)();return(0,l.jsx)(g.Z,{inline:!0,open:s,setOpen:a,title:"Sign in \uD83D\uDD10",actions:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-sky-500 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-sky-400",onClick:()=>{n().catch(console.error)},children:"Sign in"}),(0,l.jsx)("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-slate-1 px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-slate-3",onClick:()=>a(!1),children:"Close"})]}),children:(0,l.jsxs)("p",{children:["Please"," ",(0,l.jsx)("a",{className:"link",onClick:()=>void n(),children:"sign in"})," ","to deploy an Agent! \uD83E\uDD16"]})})};var f=a(9654),v=a(3407),x=a(4529),y=a(9157);a(3885);let b=[],w={tasks:[]},createTaskSlice=t=>(b.push(()=>t(w)),{...w,addTask:s=>{t(t=>({...t,tasks:[...t.tasks,{...s}]}))},updateTask:s=>{t(t=>{let a=t.tasks.map(t=>t.id===s.id&&t.taskId==s.taskId?{...s}:t);return{...t,tasks:a}})},deleteTask:s=>{t(t=>({...t,tasks:t.tasks.filter(t=>t.taskId!==s)}))}}),k=(0,y.N)((0,x.Ue)()(function(){for(var t=arguments.length,s=Array(t),a=0;a<t;a++)s[a]=arguments[a];return{...createTaskSlice(...s)}})),resetAllTaskSlices=()=>b.forEach(t=>t());var A=a(6010),S=a(3990),j=a(9883),console_AgentControls=t=>{let{lifecycle:s,disablePlay:a,handlePlay:n,handlePause:r,handleStop:o}=t;return(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(j.Z,{ping:!a,disabled:a,onClick:n,children:["running"===s&&(0,l.jsx)(S.Cd,{className:"animate-spin"}),"stopped"===s&&(0,l.jsx)(d.wXW,{}),!["running","stopped"].includes(s||"")&&(0,l.jsx)(d.gmG,{})]}),(0,l.jsx)(j.Z,{disabled:"running"!==s,onClick:r,enabledClassName:(0,A.Z)("bg-yellow-600 hover:bg-yellow-400"),children:"pausing"===s?(0,l.jsx)(S.Cd,{className:"animate-spin"}):(0,l.jsx)(d.Wh,{})}),(0,l.jsx)(j.Z,{disabled:"offline"===s||"stopped"==s,onClick:o,enabledClassName:(0,A.Z)("bg-red-600 hover:bg-red-400"),children:(0,l.jsx)(d.JuG,{})})]})},E=a(5439),T=a(7018);let[N,z,I]=["gpt-3.5-turbo","gpt-3.5-turbo-16k","gpt-4"],ChatWindowTitle=t=>{let{model:s}=t;return s===I?(0,l.jsxs)(l.Fragment,{children:["Agent",(0,l.jsx)("span",{className:"text-amber-500",children:"GPT-4"})]}):s===z?(0,l.jsxs)(l.Fragment,{children:["Agent",(0,l.jsxs)("span",{className:"text-neutral-400",children:["GPT-3.5",(0,l.jsx)("span",{className:"text-amber-500",children:"-16K"})]})]}):(0,l.jsxs)(l.Fragment,{children:["Agent",(0,l.jsx)("span",{className:"text-neutral-400",children:"GPT-3.5"})]})};var SummarizeButton=()=>{let t=v.EW.use.agent(),s=v.EW.use.lifecycle(),a=k.use.tasks().filter(t=>"completed"==t.status&&""!==t.result),n=v.EW.use.summarized(),r=v.EW.use.setSummarized();return!t||"stopped"!==s||a.length<1||n?null:(0,l.jsxs)("div",{className:(0,A.Z)("mr-2 flex flex-row items-center gap-2 rounded-lg bg-slate-1 p-2 shadow-depth-1 transition duration-300 sm:mr-4","text-xs sm:text-base"),children:[(0,l.jsx)("span",{className:"text-sm",children:"Click here to summarize the conversation"}),(0,l.jsx)(j.Z,{className:"ml-auto py-1 font-medium sm:py-1 md:py-1",onClick:async()=>{r(!0),await (null==t?void 0:t.summarize())},children:"Summarize"})]})},D=a(1071),chat=t=>{let{settings:s}=(0,f.r)(),{t:a}=(0,c.$G)("indexPage"),[n,r]=u.useState(""),o=v.EW.use.agent(),d=v.EW.use.lifecycle(),h=k.use.tasks();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"flex w-full flex-grow flex-col items-center overflow-hidden",children:(0,l.jsxs)(T.Z,{messages:t.messages,title:(0,l.jsx)(ChatWindowTitle,{model:s.customModelName}),chatControls:o?{value:n,onChange:t=>{r(t)},handleChat:async()=>{r(""),await (null==o?void 0:o.chat(n))},loading:0==h.length||""===n}:void 0,children:[t.messages.map((t,s)=>(0,l.jsx)(D.Z,{children:(0,l.jsx)(E.J,{message:t})},"".concat(s,"-").concat(t.type))),(0,l.jsx)(SummarizeButton,{})]})}),(0,l.jsx)(console_AgentControls,{disablePlay:t.disableStartAgent,lifecycle:d,handlePlay:()=>t.handlePlay(t.nameInput,t.goalInput),handlePause:()=>null==o?void 0:o.pauseAgent(),handleStop:()=>null==o?void 0:o.stopAgent()})]})},M=a(7740),R=a(9455),components_AppTitle=()=>(0,l.jsxs)("div",{id:"title",className:"relative flex flex-col items-center",children:[(0,l.jsx)("div",{className:"flex flex-row items-start",children:(0,l.jsx)("span",{className:"text-4xl font-bold text-slate-12 xs:text-5xl sm:text-7xl",style:{textShadow:"0px 5px 5px rgba(0, 0, 0, 0.1)"},children:"AgentGPT"})}),(0,l.jsxs)("div",{className:"mt-3 text-center font-mono text-[0.7em] font-bold text-white",children:[(0,l.jsx)("div",{children:(0,l.jsx)(R.Z,{className:"md:hidden",onClick:()=>{window.open("https://6h6bquxo5g1.typeform.com/to/qscfsOf1","_blank")},children:"Automate your business with Agents"})}),(0,l.jsx)("div",{className:"hidden md:flex",onClick:()=>{window.open("https://6h6bquxo5g1.typeform.com/to/qscfsOf1","_blank")},children:(0,l.jsx)(R.Z,{children:"Interested in automating businesses with AI Agents? Apply here"})})]})]}),P=a(3299);let ExampleAgentButton=t=>{let{name:s,children:a,setAgentRun:n}=t;return(0,l.jsxs)("div",{className:"w-full cursor-pointer rounded-lg border-2 border-slate-7 bg-slate-1 p-4 text-sm text-slate-12 opacity-90 shadow-depth-2 transition-all duration-300 hover:bg-slate-3 sm:text-base",onClick:()=>{n&&n(s,a)},children:[(0,l.jsx)("p",{className:"text-lg font-bold",children:s}),(0,l.jsx)("p",{className:"mt-2 text-sm",children:a})]})};var L=a(5945),G=a(6492),O=a(8228),B=a(1604),U=a(6661),W=a(3532);let OauthApi=class OauthApi{static fromSession(t){var s,a;return new OauthApi(null==t?void 0:t.accessToken,null==t?void 0:null===(a=t.user)||void 0===a?void 0:null===(s=a.organizations[0])||void 0===s?void 0:s.id)}async install(t,s){let a="".concat(U.O.NEXT_PUBLIC_VERCEL_URL).concat(s||"");return await (0,W.U2)("/api/auth/".concat(t,"?redirect=").concat(encodeURIComponent(a)),B.z.string().url(),this.accessToken,this.organizationId)}async uninstall(t){return await (0,W.U2)("/api/auth/".concat(t,"/uninstall"),B.z.object({success:B.z.boolean()}),this.accessToken,this.organizationId)}async get_info(t){return await (0,W.U2)("/api/auth/".concat(t,"/info"),B.z.object({name:B.z.string(),id:B.z.string()}).array(),this.accessToken,this.organizationId)}async get_info_sid(){return await (0,W.U2)("/api/auth/sid/info",B.z.object({connected:B.z.boolean()}),this.accessToken,this.organizationId)}constructor(t,s){this.accessToken=t,this.organizationId=s}};let F=["sid"];function useSID(t){var s;let a=OauthApi.fromSession(t),n=(0,L.NL)(),{data:r,refetch:o}=(0,G.a)(F,async()=>await a.get_info_sid(),{enabled:!!t,retry:!1}),{mutateAsync:l}=(0,O.D)(async()=>{t&&(window.location.href=await a.install("sid"))}),{mutateAsync:c}=(0,O.D)(async()=>{t&&(await a.uninstall("sid"),n.setQueriesData(F,{connected:!1}))});return{connected:null!==(s=null==r?void 0:r.connected)&&void 0!==s&&s,refetch:o,install:async()=>l(),uninstall:async()=>c(),manage:()=>void window.open("https://me.sid.ai/","_blank")}}var console_ExampleAgents=t=>{let{setAgentRun:s,setShowSignIn:a}=t,{data:n}=(0,P.useSession)();return useSID(n),(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(D.Z,{delay:.9,duration:.5,children:(0,l.jsxs)("div",{className:"my-2 grid grid-cols-1 items-stretch gap-2 sm:my-4 sm:grid-cols-3",children:[(0,l.jsx)(ExampleAgentButton,{name:"TravelGPT \uD83C\uDF34",setAgentRun:s,children:"Plan a detailed trip to Hawaii"}),(0,l.jsx)(ExampleAgentButton,{name:"CalculusGPT \uD83D\uDCDA",setAgentRun:s,children:"Create a study plan for an intro to Calculus exam"}),(0,l.jsx)(ExampleAgentButton,{name:"HustleGPT \uD83D\uDE80",setAgentRun:s,children:"Create a comprehensive report for how to scale a startup to 1000 customers"})]})})})};let V=B.z.object({name:B.z.string(),description:B.z.string(),color:B.z.string(),image_url:B.z.string().optional()}),K=B.z.object({tools:B.z.array(V)}),J=V.extend({active:B.z.boolean()}),loadTools=async t=>{let s=await (0,W.U2)("/api/agent/tools",K),a=localStorage.getItem(t),n=[];try{let t=B.z.array(J).parse(JSON.parse(null!=a?a:""));n=s.tools.map(s=>{let a=t.find(t=>t.name===s.name);return null!=a?a:{...s,active:!1}})}catch(t){n=s.tools.map(t=>({...t,active:!1}))}return n},save=(t,s)=>{localStorage.setItem(t,JSON.stringify(s))};var Q=a(7462),q=a(6652),X=a(9312),H=a(2707),Z=a(9920),Y=a(2935),$=a(192);let ee="Switch",[et,es]=(0,H.b)(ee),[ea,en]=et(ee),ei=(0,u.forwardRef)((t,s)=>{let{__scopeSwitch:a,name:n,checked:r,defaultChecked:o,required:l,disabled:c,value:d="on",onCheckedChange:h,...g}=t,[m,f]=(0,u.useState)(null),v=(0,X.e)(s,t=>f(t)),x=(0,u.useRef)(!1),y=!m||!!m.closest("form"),[b=!1,w]=(0,Z.T)({prop:r,defaultProp:o,onChange:h});return(0,u.createElement)(ea,{scope:a,checked:b,disabled:c},(0,u.createElement)($.WV.button,(0,Q.Z)({type:"button",role:"switch","aria-checked":b,"aria-required":l,"data-state":$6be4966fd9bbc698$var$getState(b),"data-disabled":c?"":void 0,disabled:c,value:d},g,{ref:v,onClick:(0,q.M)(t.onClick,t=>{w(t=>!t),y&&(x.current=t.isPropagationStopped(),x.current||t.stopPropagation())})})),y&&(0,u.createElement)($6be4966fd9bbc698$var$BubbleInput,{control:m,bubbles:!x.current,name:n,value:d,checked:b,required:l,disabled:c,style:{transform:"translateX(-100%)"}}))}),er=(0,u.forwardRef)((t,s)=>{let{__scopeSwitch:a,...n}=t,r=en("SwitchThumb",a);return(0,u.createElement)($.WV.span,(0,Q.Z)({"data-state":$6be4966fd9bbc698$var$getState(r.checked),"data-disabled":r.disabled?"":void 0},n,{ref:s}))}),$6be4966fd9bbc698$var$BubbleInput=t=>{let{control:s,checked:a,bubbles:n=!0,...r}=t,o=(0,u.useRef)(null),l=function(t){let s=(0,u.useRef)({value:t,previous:t});return(0,u.useMemo)(()=>(s.current.value!==t&&(s.current.previous=s.current.value,s.current.value=t),s.current.previous),[t])}(a),c=(0,Y.t)(s);return(0,u.useEffect)(()=>{let t=o.current,s=window.HTMLInputElement.prototype,r=Object.getOwnPropertyDescriptor(s,"checked"),c=r.set;if(l!==a&&c){let s=new Event("click",{bubbles:n});c.call(t,a),t.dispatchEvent(s)}},[l,a,n]),(0,u.createElement)("input",(0,Q.Z)({type:"checkbox","aria-hidden":!0,defaultChecked:a},r,{tabIndex:-1,ref:o,style:{...t.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function $6be4966fd9bbc698$var$getState(t){return t?"checked":"unchecked"}let Switch=t=>{let{value:s,disabled:a=!1,onChange:n}=t,[r,o]=(0,u.useState)(!1);return(0,u.useEffect)(()=>{o(s)},[s]),(0,l.jsx)(ei,{className:(0,A.W)("group","radix-state-checked:bg-sky-600 radix-state-unchecked:bg-zinc-500","relative inline-flex h-4 w-7 flex-shrink-0 rounded-full border border-transparent transition-colors duration-200 ease-in-out","focus:outline-none focus-visible:ring focus-visible:ring-sky-500 focus-visible:ring-opacity-75",a?"cursor-not-allowed opacity-60":"cursor-pointer "),disabled:a,onCheckedChange:t=>{n(t)},checked:r,children:(0,l.jsx)(er,{className:(0,A.W)("group-radix-state-checked:translate-x-3","group-radix-state-unchecked:translate-x-0","pointer-events-none inline-block h-3 w-3 transform rounded-full bg-white shadow-lg ring-0 transition duration-200 ease-in-out")})})},ToolsDialog=t=>{let{show:s,setOpen:a}=t,{activeTools:n,setToolActive:r,isSuccess:o}=function(){var t;let s=v.EW.use.setTools(),a=(0,L.NL)(),n=(0,G.a)(["tools"],()=>loadTools("tools"),{onSuccess:t=>{updateActiveTools(t)}});function updateActiveTools(t){save("tools",t),s(t.filter(t=>t.active))}return{activeTools:null!==(t=n.data)&&void 0!==t?t:[],setToolActive:(t,s)=>{a.setQueriesData(["tools"],a=>{let n=a.map(a=>a.name===t?{...a,active:s}:a);return updateActiveTools(n),n})},isSuccess:n.isSuccess}}();return(0,l.jsxs)(g.Z,{inline:!0,open:s,setOpen:a,title:"Tools",actions:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("button",{type:"button",className:"inline-flex w-full justify-center rounded-md bg-sky-500 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-sky-400",onClick:()=>{a(!1)},children:"Close"})}),children:[(0,l.jsx)("p",{children:"Select what external tools your agents have access to."}),(0,l.jsxs)("div",{className:"mt-5 flex flex-col gap-3 ",children:[n.map((t,s)=>"sid"===t.name?(0,l.jsx)(SidTool,{tool:t,onChange:r},s):(0,l.jsx)(GenericTool,{tool:t,onChange:r},s)),!o&&(0,l.jsx)("p",{className:"text-center text-red-300",children:"Error loading tools."})]})]})},GenericTool=t=>{let{tool:s,onChange:a}=t;return(0,l.jsxs)("div",{className:"flex items-center gap-3 rounded-md border border-white/30 bg-zinc-800 p-2 px-4 text-white",children:[(0,l.jsx)(ToolAvatar,{tool:s}),(0,l.jsxs)("div",{className:"flex flex-grow flex-col gap-1",children:[(0,l.jsx)("p",{className:"font-bold capitalize",children:s.name}),(0,l.jsx)("p",{className:"text-xs sm:text-sm",children:s.description})]}),(0,l.jsx)(Switch,{value:s.active,onChange:()=>a(s.name,!s.active)})]})},SidTool=t=>{let{tool:s,onChange:a}=t,{data:n}=(0,P.useSession)(),r=useSID(n);return(0,l.jsxs)("div",{className:"relative flex items-center gap-3 overflow-hidden rounded-md border border-white/30 bg-zinc-800 p-2 px-4 text-white",children:[!r.connected&&(0,l.jsxs)("div",{className:"absolute inset-0 z-10 flex items-center justify-center",children:[(0,l.jsx)("div",{className:"absolute inset-0 backdrop-blur-sm"}),(0,l.jsx)(j.Z,{className:"border-white/20 bg-gradient-to-t from-sky-500 to-sky-600 transition-all hover:bg-gradient-to-t hover:from-sky-400 hover:to-sky-600",onClick:r.install,children:"Connect your Data"})]}),(0,l.jsx)(ToolAvatar,{tool:s}),(0,l.jsxs)("div",{className:"flex flex-grow flex-col gap-1",children:[(0,l.jsx)("p",{className:"font-bold capitalize",children:s.name}),(0,l.jsx)("p",{className:"text-xs sm:text-sm",children:s.description}),r.connected&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.Z,{onClick:r.manage,children:"Manage"}),(0,l.jsx)(j.Z,{className:"rounded-full bg-gray-700 font-semibold text-white hover:bg-gray-600",onClick:r.uninstall,children:"Disconnect"})]})]}),(0,l.jsx)(Switch,{value:!!(null==r?void 0:r.connected)&&s.active,onChange:()=>a(s.name,!s.active)})]})},ToolAvatar=t=>{let{tool:s}=t;return s.image_url?(0,l.jsx)("img",{alt:s.name,width:"40px",height:"40px",src:s.image_url}):(0,l.jsx)("div",{className:"h-10 w-10 rounded-full border border-white/30 bg-amber-600"})};var eo=["x","y","z"],e=function(t){Object.assign(this,{uniforms:{},geometry:{vertices:[{x:0,y:0,z:0}]},mode:0,modifiers:{},attributes:[],multiplier:1,buffers:[]}),Object.assign(this,t),this.prepareProgram(),this.prepareUniforms(),this.prepareAttributes()};e.prototype.compileShader=function(t,s){var a=this.gl.createShader(t);return this.gl.shaderSource(a,s),this.gl.compileShader(a),a},e.prototype.prepareProgram=function(){var t=this.gl,s=this.vertex,a=this.fragment,n=t.createProgram();t.attachShader(n,this.compileShader(35633,s)),t.attachShader(n,this.compileShader(35632,a)),t.linkProgram(n),t.useProgram(n),this.program=n},e.prototype.prepareUniforms=function(){for(var t=Object.keys(this.uniforms),s=0;s<t.length;s+=1){var a=this.gl.getUniformLocation(this.program,t[s]);this.uniforms[t[s]].location=a}},e.prototype.prepareAttributes=function(){void 0!==this.geometry.vertices&&this.attributes.push({name:"aPosition",size:3}),void 0!==this.geometry.normal&&this.attributes.push({name:"aNormal",size:3}),this.attributeKeys=[];for(var t=0;t<this.attributes.length;t+=1)this.attributeKeys.push(this.attributes[t].name),this.prepareAttribute(this.attributes[t])},e.prototype.prepareAttribute=function(t){for(var s=this.geometry,a=this.multiplier,n=s.vertices,r=s.normal,o=new Float32Array(a*n.length*t.size),l=0;l<a;l+=1)for(var c=t.data&&t.data(l,a),u=l*n.length*t.size,d=0;d<n.length;d+=1)for(var h=0;h<t.size;h+=1){var g=this.modifiers[t.name];o[u]=void 0!==g?g(c,d,h,this):"aPosition"===t.name?n[d][eo[h]]:"aNormal"===t.name?r[d][eo[h]]:c[h],u+=1}this.attributes[this.attributeKeys.indexOf(t.name)].data=o,this.prepareBuffer(this.attributes[this.attributeKeys.indexOf(t.name)])},e.prototype.prepareBuffer=function(t){var s=t.data,a=t.name,n=t.size,r=this.gl.createBuffer();this.gl.bindBuffer(34962,r),this.gl.bufferData(34962,s,35044);var o=this.gl.getAttribLocation(this.program,a);this.gl.enableVertexAttribArray(o),this.gl.vertexAttribPointer(o,n,5126,!1,0,0),this.buffers[this.attributeKeys.indexOf(t.name)]={buffer:r,location:o,size:n}},e.prototype.render=function(t){var s=this,a=this.uniforms,n=this.multiplier,r=this.gl;r.useProgram(this.program);for(var o=0;o<this.buffers.length;o+=1){var l=this.buffers[o],c=l.location,u=l.buffer,d=l.size;r.enableVertexAttribArray(c),r.bindBuffer(34962,u),r.vertexAttribPointer(c,d,5126,!1,0,0)}Object.keys(t).forEach(function(s){a[s].value=t[s].value}),Object.keys(a).forEach(function(t){var n=a[t];s.uniformMap[n.type](n.location,n.value)}),r.drawArrays(this.mode,0,n*this.geometry.vertices.length),this.onRender&&this.onRender(this)},e.prototype.destroy=function(){for(var t=0;t<this.buffers.length;t+=1)this.gl.deleteBuffer(this.buffers[t].buffer);this.gl.deleteProgram(this.program),this.gl=null};var i=function(t){var s=this,a=t||{},n=a.canvas;void 0===n&&(n=document.querySelector("canvas"));var r=a.context;void 0===r&&(r={});var o=a.contextType;void 0===o&&(o="experimental-webgl");var l=a.settings;void 0===l&&(l={});var c=n.getContext(o,Object.assign({alpha:!1,antialias:!1},r));Object.assign(this,{gl:c,canvas:n,uniforms:{},instances:new Map,shouldRender:!0}),Object.assign(this,{devicePixelRatio:1,clearColor:[1,1,1,1],position:{x:0,y:0,z:2},clip:[.001,100]}),Object.assign(this,l),this.uniformMap={float:function(t,s){return c.uniform1f(t,s)},vec2:function(t,s){return c.uniform2fv(t,s)},vec3:function(t,s){return c.uniform3fv(t,s)},vec4:function(t,s){return c.uniform4fv(t,s)},mat2:function(t,s){return c.uniformMatrix2fv(t,!1,s)},mat3:function(t,s){return c.uniformMatrix3fv(t,!1,s)},mat4:function(t,s){return c.uniformMatrix4fv(t,!1,s)}},c.enable(c.DEPTH_TEST),c.depthFunc(c.LEQUAL),!1===c.getContextAttributes().alpha&&(c.clearColor.apply(c,this.clearColor),c.clearDepth(1)),this.onSetup&&this.onSetup(c),window.addEventListener("resize",function(){return s.resize()}),this.resize(),this.render()};i.prototype.resize=function(){var t=this.gl,s=this.canvas,a=this.devicePixelRatio,n=this.position;s.width=s.clientWidth*a,s.height=s.clientHeight*a;var r=t.drawingBufferWidth,o=t.drawingBufferHeight,l=r/o;t.viewport(0,0,r,o);var c=Math.tan(Math.PI/180*22.5),u=[1,0,0,0,0,1,0,0,0,0,1,0,n.x,n.y,-((l<1?1:l)*n.z),1];this.uniforms.uProjectionMatrix={type:"mat4",value:[.5/c,0,0,0,0,l/c*.5,0,0,0,0,-(this.clip[1]+this.clip[0])/(this.clip[1]-this.clip[0]),-1,0,0,-2*this.clip[1]*(this.clip[0]/(this.clip[1]-this.clip[0])),0]},this.uniforms.uViewMatrix={type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},this.uniforms.uModelMatrix={type:"mat4",value:u}},i.prototype.toggle=function(t){t!==this.shouldRender&&(this.shouldRender=void 0!==t?t:!this.shouldRender,this.shouldRender&&this.render())},i.prototype.render=function(){var t=this;this.gl.clear(16640),this.instances.forEach(function(s){s.render(t.uniforms)}),this.onRender&&this.onRender(this),this.shouldRender&&requestAnimationFrame(function(){return t.render()})},i.prototype.add=function(t,s){void 0===s&&(s={uniforms:{}}),void 0===s.uniforms&&(s.uniforms={}),Object.assign(s.uniforms,JSON.parse(JSON.stringify(this.uniforms))),Object.assign(s,{gl:this.gl,uniformMap:this.uniformMap});var a=new e(s);return this.instances.set(t,a),a},i.prototype.remove=function(t){var s=this.instances.get(t);void 0!==s&&(s.destroy(),this.instances.delete(t))},i.prototype.destroy=function(){var t=this;this.instances.forEach(function(s,a){s.destroy(),t.instances.delete(a)}),this.toggle(!1)};var el="theta",ec="mapSamples",eu="mapBrightness",ed="baseColor",eh="markerColor",eg="glowColor",ep="markers",em="diffuse",ef="devicePixelRatio",ev="dark",ex="offset",ey="scale",eb="opacity",ew="mapBaseBrightness",ek={phi:"A",[el]:"B",[ec]:"l",[eu]:"E",[ed]:"R",[eh]:"S",[eg]:"y",[em]:"F",[ev]:"G",[ex]:"x",[ey]:"C",[eb]:"H",[ew]:"I"},{PI:eA,sin:eS,cos:ej}=Math,C=t=>[].concat(...t.map(t=>{let[s,a]=t.location;s=s*eA/180,a=a*eA/180-eA;let n=ej(s);return[-n*ej(a),eS(s),n*eS(a),t.size]}),[0,0,0,0]),p=(t,s)=>{let _=(t,a,n)=>({type:t,value:void 0===s[a]?n:s[a]}),a=t.getContext("webgl")?"webgl":"experimental-webgl",n=new i({canvas:t,contextType:a,context:{alpha:!0,stencil:!1,antialias:!0,depth:!1,preserveDrawingBuffer:!1,...s.context},settings:{[ef]:s[ef]||1,onSetup:t=>{let s=t.RGB,a=t.UNSIGNED_BYTE,n=t.TEXTURE_2D,r=t.createTexture();t.bindTexture(n,r),t.texImage2D(n,0,s,1,1,0,s,a,new Uint8Array([0,0,0,0]));let o=new Image;o.onload=()=>{t.bindTexture(n,r),t.texImage2D(n,0,s,s,a,o),t.generateMipmap(n);let l=t.getParameter(t.CURRENT_PROGRAM),c=t.getUniformLocation(l,"J");t.texParameteri(n,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(n,t.TEXTURE_MAG_FILTER,t.NEAREST),t.uniform1i(c,0)},o.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAACAAQAAAADMzoqnAAAAAXNSR0IArs4c6QAABA5JREFUeNrV179uHEUAx/Hf3JpbF+E2VASBsmVKTBcpKJs3SMEDcDwBiVJAAewYEBUivIHT0uUBIt0YCovKD0CRjUC4QfHYh8hYXu+P25vZ2Zm9c66gMd/GJ/tz82d3bk8GN4SrByYF2366FNTACIAkivVAAazQdnf3MvAlbNUQfOPAdQDvSAimMWhwy4I2g4SU+Kp04ISLpPBAKLxPyic3O/CCi+Y7rUJbiodcpDOFY7CgxCEXmdYD2EYK2s5lApOx5pEDDYCUwM1XdJUwBV11QQMg59kePSCaPAASQMEL2hwo6TJFgxpg+TgC2ymXPbuvc40awr3D1QCFfbH9kcoqAOkZozpQo0aqAGQRKCog/+tjkgbNFEtg2FffBvBGlSxHoAaAa1u6X4PBAwDiR8FFsrQgeUhfJTSALaB9jy5NCybJPn1SVFiWk7ywN+KzhH1aKAuydhGkbEF4lWohLXDXavlyFgHY7LBnLRdlAP6BS5Cc8RfVDXbkwN/oIvmY+6obbNeBP0JwTuMGu9gTzy1Q4RS/cWpfzszeYwd+CAFrtBW/Hur0gLbJGlD+/OjVwe/drfBxkbbg63dndEDfiEBlAd7ac0BPe1D6Jd8dfbLH+RI0OzseFB5s01/M+gMdAeluLOCAuaUA9Lezo/vSgXoCX9rtEiXnp7Q1W/CNyWcd8DXoS6jH/YZ5vAJEWY2dXFQe2TUgaFaNejCzJ98g6HnlVrsE58sDcYqg+9XY75fPqdoh/kRQWiXKg8MWlJQxUFMPjqnyujhFBE7UxIMjyszk0QwQlFsezImsyvUYYYVED2pk6m0Tg8T04Fwjk2kdAwSACqlM6gRRt3vQYAFGX0Ah7Ebx1H+MDRI5ui0QldH4j7FGcm90XdxD2Jg1AOEAVAKhEFXSn4cKUELurIAKwJ3MArypPscQaLhJFICJ0ohjDySAdH8AhDtCiTuMycH8CXzhH9jUACAO5uMhoAwA5i+T6WAKmmAqnLy80wxHqIPFYpqCwxGaYLt4Dyievg5kEoVEUAhs6pqKgFtDQYOuaXypaWKQfIuwwoGSZgfLsu/XAtI8cGN+h7Cc1A5oLOMhwlIPXuhu48AIvsSBkvtV9wsJRKCyYLfq5lTrQMFd1a262oqBck9K1V0YjQg0iEYYgpS1A9GlXQV5cykwm4A7BzVsxQqo7E+zCegO7Ma7yKgsuOcfKbMBwLC8wvVNYDsANYalEpOAa6zpWjTeMKGwEwC1CiQewJc5EKfgy7GmRAZA4vUVGwE2dPM/g0xuAInE/yG5aZ8ISxWGfYigUVbdyBElTHh2uCwGdfCkOLGgQVBh3Ewp+/QK4CDlR5Ws/Zf7yhCf8pH7vinWAvoVCQ6zz0NX5V/6GkAVV+2/5qsJ/gU8bsxpM8IeAQAAAABJRU5ErkJggg=="}}});return n.add("",{vertex:"attribute vec3 aPosition;uniform mat4 uProjectionMatrix;uniform mat4 uModelMatrix;uniform mat4 uViewMatrix;void main(){gl_Position=uProjectionMatrix*uModelMatrix*uViewMatrix*vec4(aPosition,1.);}",fragment:"precision highp float;uniform vec2 t,x;uniform vec3 R,S,y;uniform vec4 z[64];uniform float A,B,l,C,D,E,F,G,H,I;uniform sampler2D J;float K=1./l;mat3 L(float a,float b){float c=cos(a),d=cos(b),e=sin(a),f=sin(b);return mat3(d,f*e,-f*c,0.,c,e,f,d*-e,d*c);}vec3 w(vec3 c,out float v){c=c.xzy;float p=max(2.,floor(log2(2.236068*l*3.141593*(1.-c.z*c.z))*.72021));vec2 g=floor(pow(1.618034,p)/2.236068*vec2(1.,1.618034)+.5),d=fract((g+1.)*.618034)*6.283185-3.883222,e=-2.*g,f=vec2(atan(c.y,c.x),c.z-1.),q=floor(vec2(e.y*f.x-d.y*(f.y*l+1.),-e.x*f.x+d.x*(f.y*l+1.))/(d.x*e.y-e.x*d.y));float n=3.141593;vec3 r;for(float h=0.;h<4.;h+=1.){vec2 s=vec2(mod(h,2.),floor(h*.5));float j=dot(g,q+s);if(j>l)continue;float a=j,b=0.;if(a>=524288.)a-=524288.,b+=.803894;if(a>=262144.)a-=262144.,b+=.901947;if(a>=131072.)a-=131072.,b+=.950973;if(a>=65536.)a-=65536.,b+=.475487;if(a>=32768.)a-=32768.,b+=.737743;if(a>=16384.)a-=16384.,b+=.868872;if(a>=8192.)a-=8192.,b+=.934436;if(a>=4096.)a-=4096.,b+=.467218;if(a>=2048.)a-=2048.,b+=.733609;if(a>=1024.)a-=1024.,b+=.866804;if(a>=512.)a-=512.,b+=.433402;if(a>=256.)a-=256.,b+=.216701;if(a>=128.)a-=128.,b+=.108351;if(a>=64.)a-=64.,b+=.554175;if(a>=32.)a-=32.,b+=.777088;if(a>=16.)a-=16.,b+=.888544;if(a>=8.)a-=8.,b+=.944272;if(a>=4.)a-=4.,b+=.472136;if(a>=2.)a-=2.,b+=.236068;if(a>=1.)a-=1.,b+=.618034;float k=fract(b)*6.283185,i=1.-2.*j*K,m=sqrt(1.-i*i);vec3 o=vec3(cos(k)*m,sin(k)*m,i);float u=length(c-o);if(u<n)n=u,r=o;}v=n;return r.xzy;}void main(){vec2 b=(gl_FragCoord.xy/t*2.-1.)/C-x*vec2(1.,-1.)/t;b.x*=t.x/t.y;float c=dot(b,b);vec4 M=vec4(0.);float m=0.;if(c<=.64){for(int d=0;d<2;d++){vec4 e=vec4(0.);float a;vec3 u=vec3(0.,0.,1.),f=normalize(vec3(b,sqrt(.64-c)));f.z*=d>0?-1.:1.,u.z*=d>0?-1.:1.;vec3 g=f*L(B,A),h=w(g,a);float n=asin(h.y),i=acos(-h.x/cos(n));i=h.z<0.?-i:i;float N=max(texture2D(J,vec2(i*.5/3.141593,-(n/3.141593+.5))).x,I),O=smoothstep(8e-3,0.,a),j=dot(f,u),v=pow(j,F)*E,o=N*O*v,T=mix((1.-o)*pow(j,.4),o,G)+.1;e+=vec4(R*T,1.);int U=int(D);float p=0.;for(int k=0;k<64;k++){if(k>=U)break;vec4 q=z[k];vec3 r=q.xyz,P=r-g;float s=q.w;if(dot(P,P)>s*s*4.)continue;vec3 V=w(r,a);a=length(V-g),a<s?p+=smoothstep(s*.5,0.,a):0.;}p=min(1.,p*v),e.xyz=mix(e.xyz,S,p),e.xyz+=pow(1.-j,4.)*y,M+=e*(1.+(d>0?-H:H))/2.;}m=pow(dot(normalize(vec3(-b,sqrt(1.-c))),vec3(0.,0.,1.)),4.)*smoothstep(0.,1.,.2/(c-.64));}else{float Q=sqrt(.2/(c-.64));m=smoothstep(.5,1.,Q/(Q+1.));}gl_FragColor=M+vec4(m*y,m);}",uniforms:{t:{type:"vec2",value:[s.width,s.height]},A:_("float","phi"),B:_("float",el),l:_("float",ec),E:_("float",eu),I:_("float",ew),R:_("vec3",ed),S:_("vec3",eh),F:_("float",em),y:_("vec3",eg),G:_("float",ev),z:{type:"vec4",value:C(s[ep])},D:{type:"float",value:s[ep].length},x:_("vec2",ex,[0,0]),C:_("float",ey,1),H:_("float",eb,1)},mode:4,geometry:{vertices:[{x:-100,y:100,z:0},{x:-100,y:-100,z:0},{x:100,y:100,z:0},{x:100,y:-100,z:0},{x:-100,y:-100,z:0},{x:100,y:100,z:0}]},onRender:({uniforms:t})=>{let a={};if(s.onRender){for(let n in a=s.onRender(a)||a,ek)void 0!==a[n]&&(t[ek[n]].value=a[n]);void 0!==a[ep]&&(t.z.value=C(a[ep]),t.D.value=a[ep].length),a.width&&a.height&&(t.t.value=[a.width,a.height])}}}),n};function Globe(){let t=(0,u.useRef)(null);return(0,u.useEffect)(()=>{if(!t.current)return;let s=0,a=p(t.current,{devicePixelRatio:2,width:1400,height:1400,phi:0,theta:0,dark:0,diffuse:1.2,mapSamples:16e3,mapBrightness:6,baseColor:[1,1,1],markerColor:[1,1,0],glowColor:[.757,.784,.804],markers:[],onRender:t=>{t.phi=s,s+=.001}});return()=>{t.current&&a&&a.destroy()}},[]),(0,l.jsx)("canvas",{ref:t,style:{width:700,height:700,aspectRatio:"1"}})}var eE=a(2896),landing=t=>{let[s,a]=(0,u.useState)(!1),{t:n}=(0,c.$G)("indexPage"),r=v.EW.use.agent();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ToolsDialog,{show:s,setOpen:a}),(0,l.jsx)(M.E.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{duration:.75,type:"easeInOut"},className:"z-10",children:(0,l.jsx)(components_AppTitle,{})}),(0,l.jsx)("div",{className:"absolute left-0 right-0 m-auto grid place-items-center overflow-hidden opacity-40",children:(0,l.jsx)(Globe,{})}),(0,l.jsx)(M.E.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{duration:.75,delay:1,type:"easeInOut"},className:"z-10",children:(0,l.jsx)(console_ExampleAgents,{setAgentRun:t.setAgentRun,setShowSignIn:t.setShowSignInDialog})}),(0,l.jsxs)(M.E.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.75,delay:.5,type:"easeInOut"},className:"z-10 flex w-full flex-col gap-6",children:[(0,l.jsx)(eE.Z,{inputRef:t.goalInputRef,left:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.QJe,{}),(0,l.jsx)("span",{className:"ml-2",children:"".concat(n("LABEL_AGENT_GOAL"))})]}),disabled:null!=r,value:t.goalInput,onChange:s=>t.setGoalInput(s.target.value),onKeyDown:t.handleKeyPress,placeholder:"".concat(n("PLACEHOLDER_AGENT_GOAL")),type:"textarea"}),(0,l.jsxs)("div",{className:"flex w-full flex-row items-center justify-center gap-3",children:[(0,l.jsx)(j.Z,{ping:!0,onClick:()=>a(!0),className:"h-full bg-gradient-to-t from-slate-9 to-slate-12 hover:shadow-depth-3",children:(0,l.jsx)(d.p4t,{})}),(0,l.jsx)(j.Z,{onClick:t.handlePlay,className:"border-0 bg-gradient-to-t from-[#02FCF1] to-[#A02BFE] subpixel-antialiased saturate-[75%] hover:saturate-100",children:(0,l.jsx)(d.gmG,{})})]})]})]})},eT=a(3027),eC=a(2386),eN=a(9669),ez=a.n(eN);let post=async(t,s,a)=>{var n;let r=function(t){let s={};return(null==t?void 0:t.accessToken)&&(s.Authorization="Bearer ".concat(t.accessToken)),s}(a);return n=t,t=U.O.NEXT_PUBLIC_BACKEND_URL+n,(await ez().post(t,s,{headers:r})).data};async function withRetries(t,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;for(let n=0;n<a+1;n++)try{return await t()}catch(t){if(!await s(t))return}}let AgentApi=class AgentApi{async createAgent(){if(this.agentId)return;let t=await this.props.agentUtils.createAgent({goal:this.props.goal});this.agentId=null==t?void 0:t.id}saveMessages(t){this.agentId&&this.props.agentUtils.saveAgent({id:this.agentId,tasks:t})}async getInitialTasks(){return(await this.post("/api/agent/start",{})).newTasks}async getAdditionalTasks(t,s){return(await this.post("/api/agent/create",{result:s,last_task:t.current,tasks:t.remaining,completed_tasks:t.completed})).newTasks}async analyzeTask(t){return await this.post("/api/agent/analyze",{task:t,tool_names:v.EW.getState().tools.map(t=>t.name)})}async post(t,s){let a={model_settings:this.props.model_settings,goal:this.props.goal,run_id:this.runId,...s};try{v.EW.getState().setIsAgentThinking(!0);let{run_id:s,...n}=await post(t,a,this.props.session);return void 0===this.runId&&(this.runId=s),n}finally{v.EW.getState().setIsAgentThinking(!1)}}constructor(t){this.props=t}};let eI="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var e_={randomUUID:eI};let eD=new Uint8Array(16);function rng(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(eD)}let eM=[];for(let t=0;t<256;++t)eM.push((t+256).toString(16).slice(1));function unsafeStringify(t,s=0){return eM[t[s+0]]+eM[t[s+1]]+eM[t[s+2]]+eM[t[s+3]]+"-"+eM[t[s+4]]+eM[t[s+5]]+"-"+eM[t[s+6]]+eM[t[s+7]]+"-"+eM[t[s+8]]+eM[t[s+9]]+"-"+eM[t[s+10]]+eM[t[s+11]]+eM[t[s+12]]+eM[t[s+13]]+eM[t[s+14]]+eM[t[s+15]]}var esm_browser_v4=function(t,s,a){if(e_.randomUUID&&!s&&!t)return e_.randomUUID();t=t||{};let n=t.random||(t.rng||rng)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,s){a=a||0;for(let t=0;t<16;++t)s[a+t]=n[t];return s}return unsafeStringify(n)};let DefaultAgentRunModel=class DefaultAgentRunModel{updateTaskStatus(t,s){return this.updateTask({...t,status:s})}updateTaskResult(t,s){return this.updateTask({...t,result:s})}updateTask(t){return k.getState().updateTask(t),t}constructor(t){this.getId=()=>this.id,this.getGoal=()=>this.goal,this.getLifecycle=()=>v.EW.getState().lifecycle,this.setLifecycle=t=>v.EW.getState().setLifecycle(t),this.getRemainingTasks=()=>k.getState().tasks.filter(t=>"started"===t.status),this.getCurrentTask=()=>this.getRemainingTasks()[0],this.getCompletedTasks=()=>k.getState().tasks.filter(t=>"completed"===t.status),this.addTask=t=>k.getState().addTask({id:esm_browser_v4().toString(),type:"task",value:t,status:"started",result:""}),this.id=esm_browser_v4().toString(),this.goal=t}};let eR=0,eP=0;var esm_browser_v1=function(t,s,a){let n=s&&a||0,l=s||Array(16),c=(t=t||{}).node||r,u=void 0!==t.clockseq?t.clockseq:o;if(null==c||null==u){let s=t.random||(t.rng||rng)();null==c&&(c=r=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==u&&(u=o=(s[6]<<8|s[7])&16383)}let d=void 0!==t.msecs?t.msecs:Date.now(),h=void 0!==t.nsecs?t.nsecs:eP+1,g=d-eR+(h-eP)/1e4;if(g<0&&void 0===t.clockseq&&(u=u+1&16383),(g<0||d>eR)&&void 0===t.nsecs&&(h=0),h>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");eR=d,eP=h,o=u,d+=122192928e5;let m=((268435455&d)*1e4+h)%4294967296;l[n++]=m>>>24&255,l[n++]=m>>>16&255,l[n++]=m>>>8&255,l[n++]=255&m;let f=d/4294967296*1e4&268435455;l[n++]=f>>>8&255,l[n++]=255&f,l[n++]=f>>>24&15|16,l[n++]=f>>>16&255,l[n++]=u>>>8|128,l[n++]=255&u;for(let t=0;t<6;++t)l[n+t]=c[t];return s||unsafeStringify(l)};let toApiModelSettings=(t,s)=>{let a=null==s?void 0:s.user;return{language:t.language.name,model:a?t.customModelName:"gpt-3.5-turbo",temperature:t.customTemperature,max_tokens:a?t.maxTokens:500,custom_api_key:t.customApiKey}},fetchData=async(t,s,a)=>{var n;t=U.O.NEXT_PUBLIC_BACKEND_URL+t;let r=await fetch(t,{method:"POST",cache:"no-cache",keepalive:!0,headers:{"Content-Type":"application/json",Accept:"text/event-stream",Authorization:"Bearer ".concat(a)},body:JSON.stringify(s)});if(409===r.status){let t=await r.json();throw Error(t.detail)}return null===(n=r.body)||void 0===n?void 0:n.getReader()};async function readStream(t){let s=await t.read();return s.done?null:new TextDecoder().decode(s.value)}async function processStream(t,s,a,n){for(s();;){if(n()){await t.cancel();return}let s=await readStream(t);if(null===s)break;a(s)}}let streamText=async(t,s,a,n,r,o)=>{let l=await fetchData(t,s,a);if(!l){console.error("Reader is undefined!");return}await processStream(l,n,r,o)};let ExecuteTaskWork=class ExecuteTaskWork{constructor(t,s,a){this.parent=t,this.task=s,this.analysis=a,this.result="",this.run=async()=>{var t;let s={...this.task,id:esm_browser_v1(),status:"completed",info:"Loading..."};this.parent.messageService.sendMessage({...s,status:"completed"}),await streamText("/api/agent/execute",{run_id:this.parent.api.runId,goal:this.parent.model.getGoal(),task:this.task.value,analysis:this.analysis,model_settings:toApiModelSettings(this.parent.modelSettings,this.parent.session)},(null===(t=this.parent.api.props.session)||void 0===t?void 0:t.accessToken)||"",()=>{s.info=""},t=>{s.info+=t,this.task=this.parent.model.updateTaskResult(this.task,s.info||""),this.parent.messageService.updateMessage(s)},()=>"stopped"===this.parent.model.getLifecycle()),this.result=s.info||"",this.parent.api.saveMessages([s]),this.task=this.parent.model.updateTaskStatus(this.task,"completed")},this.conclude=async()=>void 0,this.next=()=>void 0,this.onError=t=>(this.parent.messageService.sendErrorMessage(t),!0)}};let AnalyzeTaskWork=class AnalyzeTaskWork{constructor(t,s){this.parent=t,this.task=s,this.analysis=void 0,this.run=async()=>{this.task=this.parent.model.updateTaskStatus(this.task,"executing"),this.analysis=await this.parent.api.analyzeTask(this.task.value)},this.conclude=async()=>{let t;t=this.analysis?this.parent.messageService.sendAnalysisMessage(this.analysis):this.parent.messageService.skipTaskMessage(this.task),this.parent.api.saveMessages([t])},this.next=()=>{if(this.analysis)return new ExecuteTaskWork(this.parent,this.task,this.analysis)},this.onError=t=>(this.parent.messageService.sendErrorMessage(t),!0)}};let ChatWork=class ChatWork{constructor(t,s){this.parent=t,this.message=s,this.run=async()=>{var t;let s={type:"task",status:"completed",value:"Response for '".concat(this.message,"'"),id:esm_browser_v1(),info:"Loading..."};this.parent.messageService.sendMessage({...s}),await streamText("/api/agent/chat",{run_id:this.parent.api.runId,goal:this.parent.model.getGoal(),model_settings:toApiModelSettings(this.parent.modelSettings,this.parent.session),message:this.message,results:this.parent.model.getCompletedTasks().filter(t=>t.result&&""!==t.result).map(t=>t.result||"")},(null===(t=this.parent.api.props.session)||void 0===t?void 0:t.accessToken)||"",()=>{s.info=""},t=>{s.info+=t,this.parent.messageService.updateMessage(s)},()=>"stopped"===this.parent.model.getLifecycle()),this.parent.api.saveMessages([s])},this.conclude=async()=>void 0,this.next=()=>void 0,this.onError=t=>(this.parent.messageService.sendErrorMessage(t),!0)}};let StartGoalWork=class StartGoalWork{constructor(t){this.parent=t,this.tasksValues=[],this.run=async()=>{let t=this.parent.messageService.sendGoalMessage(this.parent.model.getGoal());this.tasksValues=await this.parent.api.getInitialTasks(),await this.parent.api.createAgent(),this.parent.api.saveMessages([t])},this.conclude=async()=>{let t=await this.parent.createTaskMessages(this.tasksValues);this.parent.api.saveMessages(t)},this.onError=t=>(this.parent.messageService.sendErrorMessage(t),!0),this.next=()=>void 0}};let SummarizeWork=class SummarizeWork{constructor(t){this.parent=t,this.run=async()=>{var t;let s={type:"task",status:"completed",value:"Summarizing ".concat(this.parent.model.getGoal()),id:esm_browser_v1(),info:"Loading..."};this.parent.messageService.sendMessage({...s}),await streamText("/api/agent/summarize",{run_id:this.parent.api.runId,goal:this.parent.model.getGoal(),model_settings:toApiModelSettings(this.parent.modelSettings,this.parent.session),results:this.parent.model.getCompletedTasks().filter(t=>t.result&&""!==t.result).map(t=>t.result||"")},(null===(t=this.parent.api.props.session)||void 0===t?void 0:t.accessToken)||"",()=>{s.info=""},t=>{s.info+=t,this.parent.messageService.updateMessage(s)},()=>"stopped"===this.parent.model.getLifecycle()),this.parent.api.saveMessages([s])},this.conclude=async()=>void 0,this.next=()=>void 0,this.onError=t=>(this.parent.messageService.sendErrorMessage(t),!0)}};let eL=B.z.object({error:B.z.string(),detail:B.z.string(),code:B.z.number().optional()}),isPlatformError=t=>eL.safeParse(t).success,isRetryableError=t=>{if(ez().isAxiosError(t)){var s,a,n;if(isPlatformError(null===(s=t.response)||void 0===s?void 0:s.data)){let s=null===(n=t.response)||void 0===n?void 0:n.data.error;return"MaxLoopsError"!==s}return(null===(a=t.response)||void 0===a?void 0:a.status)!==429}return!0},eG=B.z.object({loc:B.z.array(B.z.string()),msg:B.z.string(),type:B.z.string()}),eO=B.z.object({detail:B.z.array(eG)}),isValueError=t=>eO.safeParse(t).success;var eB=class{async run(){for(this.model.setLifecycle("running"),this.lastConclusion&&(await this.lastConclusion(),this.lastConclusion=void 0),this.addTasksIfWorklogEmpty();this.workLog[0];){if("pausing"===this.model.getLifecycle()&&this.model.setLifecycle("paused"),"running"!==this.model.getLifecycle())return;let t=this.workLog[0];await this.runWork(t,()=>"stopped"===this.model.getLifecycle()),this.workLog.shift(),"running"!==this.model.getLifecycle()?this.lastConclusion=()=>t.conclude():await t.conclude();let s=t.next();s&&this.workLog.push(s),this.addTasksIfWorklogEmpty()}"pausing"===this.model.getLifecycle()&&this.model.setLifecycle("paused"),"running"===this.model.getLifecycle()&&this.stopAgent()}async runWork(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>!1;await withRetries(async()=>{s()||await t.run()},async s=>{var a;let n=(null===(a=t.onError)||void 0===a?void 0:a.call(t,s))||!0;return isRetryableError(s)?(n&&(v.EW.getState().setIsAgentThinking(!0),await new Promise(t=>setTimeout(t,2e3))),n):(this.stopAgent(),!1)}),v.EW.getState().setIsAgentThinking(!1)}pauseAgent(){this.model.setLifecycle("pausing")}stopAgent(){this.model.setLifecycle("stopped")}async summarize(){this.model.setLifecycle("running");let t=new SummarizeWork(this);await this.runWork(t),await t.conclude(),this.model.setLifecycle("stopped")}async chat(t){"running"==this.model.getLifecycle()&&this.pauseAgent();let s=!1;"stopped"==this.model.getLifecycle()&&(s=!0,this.model.setLifecycle("pausing"));let a=new ChatWork(this,t);await this.runWork(a),await a.conclude(),s&&this.model.setLifecycle("stopped")}async createTaskMessages(t){let s=[];for(let a of t)s.push(this.messageService.startTask(a)),this.model.addTask(a),await new Promise(t=>setTimeout(t,150));return s}constructor(t,s,a,n,r){this.addTasksIfWorklogEmpty=()=>{if(this.workLog.length>0)return;let t=this.model.getCurrentTask();t&&this.workLog.push(new AnalyzeTaskWork(this,t))},this.model=t,this.messageService=s,this.modelSettings=a,this.session=r,this.api=n,this.workLog=[new StartGoalWork(this)]}},eU=a(2165);let translate=(t,s)=>{var a;let n=s?{ns:s}:void 0;return null!==(a=null===c.ag||void 0===c.ag?void 0:c.ag.t(t,t,n))&&void 0!==a?a:t};let MessageService=class MessageService{constructor(t){this.sendMessage=t=>(this.renderMessage({...t}),t),this.updateMessage=t=>(v.GH.getState().updateMessage(t),t),this.skipTaskMessage=t=>this.sendMessage({type:"system",value:"\uD83E\uDD7A Skipping task: ".concat(t.value)}),this.startTask=t=>this.sendMessage({taskId:esm_browser_v1().toString(),value:t,status:"started",type:"task"}),this.sendGoalMessage=t=>this.sendMessage({type:eU.nD,value:t}),this.sendAnalysisMessage=t=>{let s="⏰ Generating response...";return"search"==t.action&&(s='\uD83D\uDD0D Searching the web for "'.concat(t.arg,'"...')),"wikipedia"==t.action&&(s='\uD83C\uDF10 Searching Wikipedia for "'.concat(t.arg,'"...')),"image"==t.action&&(s='\uD83C\uDFA8 Generating an image with prompt: "'.concat(t.arg,'"...')),"code"==t.action&&(s="\uD83D\uDCBB Writing code..."),this.sendMessage({type:eU.RK,value:s})},this.sendErrorMessage=t=>{let s="An unknown error occurred. Please try again later.";if("string"==typeof t)s=t;else if(ez().isAxiosError(t)&&"Network Error"==t.message)s="Error attempting to connect to the server.";else if(ez().isAxiosError(t)){var a,n,r;let o=(null===(a=t.response)||void 0===a?void 0:a.data)||{};switch(null===(n=t.response)||void 0===n?void 0:n.status){case 409:s=isPlatformError(o)?o.detail:"An Unknown Error Occurred, Please Try Again!";break;case 422:if(isValueError(o)){let t=o.detail.map(t=>t.msg);s=t.join("\n")}break;case 429:if((null===(r=t.response)||void 0===r?void 0:r.data)&&"detail"in t.response.data){let{detail:a}=t.response.data;s=a||"Too many requests. Please try again later."}else s="Too many requests. Please try again later.";break;case 403:s="Authentication Error. Please make sure you are logged in.";break;case 404:s="ERROR_OPENAI_API_KEY_NO_GPT4";break;default:s="ERROR_ACCESSING_OPENAI_API_KEY"}}else t instanceof Error&&(s=t.message);return this.sendMessage({type:"error",value:translate(s,"errors")})},this.renderMessage=t}};var eW=a(4112),eF=!0,pages=()=>{let{t}=(0,c.$G)("indexPage"),s=v.GH.use.addMessage(),a=v.GH.use.messages();k.use.tasks();let n=v.EW.use.setAgent(),r=v.EW.use.lifecycle(),o=v.EW.use.agent(),{session:d}=(0,m.a)(),h=eW.m.use.nameInput(),g=eW.m.use.setNameInput(),x=eW.m.use.goalInput(),y=eW.m.use.setGoalInput(),{settings:b}=(0,f.r)(),[w,A]=u.useState(!1),S=function(){let{status:t}=(0,m.a)(),s=eT.h.useContext(),a=eT.h.agent.create.useMutation({onSuccess:t=>(s.agent.getAll.setData(void 0,s=>[t,...null!=s?s:[]]),t)}),createAgent=async s=>"authenticated"===t?await a.mutateAsync(s):void 0,n=eT.h.agent.save.useMutation();return{createAgent,saveAgent:s=>{"authenticated"===t&&n.mutate(s)}}}(),j=(0,u.useRef)(null);(0,u.useEffect)(()=>{var t;null==j||null===(t=j.current)||void 0===t||t.focus()},[]);let setAgentRun=(t,s)=>{g(t),y(s),handlePlay(s)},E=null!==o&&!["paused","stopped"].includes(r)||/^[\s\f\n\r\t\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000\ufeff\x09\x0a\x0b\x0c\x0d\x20\xa0]+$/.test(x)||""===x,handlePlay=t=>{"stopped"===r?handleRestart():handleNewAgent(t.trim())},handleNewAgent=t=>{if(null===d){storeAgentDataInLocalStorage("",t),A(!0);return}if(o&&"paused"==r){null==o||o.run().catch(console.error);return}let a=new DefaultAgentRunModel(t.trim()),l=new MessageService(s),c=new AgentApi({model_settings:toApiModelSettings(b,d),goal:t,session:d,agentUtils:S}),u=new eB(a,l,b,c,null!=d?d:void 0);n(u),null==u||u.run().then(console.log).catch(console.error)},storeAgentDataInLocalStorage=(t,s)=>{localStorage.setItem("agentData",JSON.stringify({name:t,goal:s}))},getAgentDataFromLocalStorage=()=>{let t=localStorage.getItem("agentData");return t?JSON.parse(t):null};(0,u.useEffect)(()=>{if(null!==d){let t=getAgentDataFromLocalStorage();t&&(g(t.name),y(t.goal),localStorage.removeItem("agentData"))}},[d,y,g]);let handleRestart=()=>{(0,v.JO)(),resetAllTaskSlices(),(0,v.UZ)()};return(0,l.jsxs)(eC.Z,{onReload:()=>{null==o||o.stopAgent(),handleRestart()},children:[(0,l.jsx)(HelpDialog,{}),(0,l.jsx)(SignInDialog,{show:w,setOpen:A}),(0,l.jsx)("div",{id:"content",className:"flex min-h-screen w-full items-center justify-center",children:(0,l.jsx)("div",{id:"layout",className:"relative flex h-screen w-full max-w-screen-md flex-col items-center justify-center gap-5 overflow-hidden p-2 py-10 sm:gap-3 sm:p-4",children:null!==o?(0,l.jsx)(chat,{messages:a,disableStartAgent:E,handlePlay:handlePlay,nameInput:h,goalInput:x,setShowSignInDialog:A,setAgentRun:setAgentRun}):(0,l.jsx)(landing,{messages:a,disableStartAgent:E,handlePlay:()=>handlePlay(x),handleKeyPress:t=>{"Enter"!==t.key||E||t.shiftKey||handlePlay(x)},goalInputRef:j,goalInput:x,setGoalInput:y,setShowSignInDialog:A,setAgentRun:setAgentRun})})})]})}},3532:function(t,s,a){"use strict";a.d(s,{U2:function(){return get}});var n=a(6661);let get=async(t,s,a,r)=>{let o=await fetch("".concat(n.O.NEXT_PUBLIC_BACKEND_URL).concat(t),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a||""),...r?{"X-Organization-Id":r}:{}}});if(!o.ok)throw Error("Request failed");return s.parse(await o.json())}},4112:function(t,s,a){"use strict";a.d(s,{m:function(){return c}});var n=a(4529),r=a(9157);let o=[],l={nameInput:"",goalInput:""},createAgentInputSlice=t=>(o.push(()=>t(l)),{...l,setNameInput:s=>{t(()=>({nameInput:s}))},setGoalInput:s=>{t(()=>({goalInput:s}))},resetInputs:()=>{t(l)}}),c=(0,r.N)((0,n.Ue)()(function(){for(var t=arguments.length,s=Array(t),a=0;a<t;a++)s[a]=arguments[a];return{...createAgentInputSlice(...s)}}))}},function(t){t.O(0,[445,778,13,186,987,111,955,609,999,983,667,702,16,876,575,967,62,774,888,179],function(){return t(t.s=8312)}),_N_E=t.O()}]);